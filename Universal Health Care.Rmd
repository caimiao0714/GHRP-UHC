---
title: "Association between XXX and Life Expectency in 139 Countries: A Retrospective Longitudinal Study"
subtitle: 
author:
  - name: Miao Cai
    email: miao.cai@slu.edu
    affiliation: SLU
  - name: Asabe Garba
    email: asabe.garba@slu.edu
    affiliation: SLU
  - name: Xin Li
    email: xl60@iu.edu
    affiliation: WHU
  - name: Xiaojun Lin
    email: xjlin@hust.edu.cn
    affiliation: SCU
    footnote: Corresponding Author
address:
  - code: SLU
    address: Saint Louis University, Saint Louis, MO, 63108
  - code: SCU
    address: Sichuan University, Chengdu, Sichuan, China
  - code: WHU
    address: Wuhan University, Wuhan, Hubei, China
journal: "Global Health Research and Policy - Thematic Series: Universal Health Coverage"
date: "`r Sys.Date()`"
bibliography: ref.bib
csl: BMC.csl
output:
  bookdown::pdf_book:
    base_format: rticles::elsevier_article
link-citations: true
linkcolor: blue
geometry: "left=3cm,right=3cm,top=3cm,bottom=3cm"
fig_caption: yes
indent: true
link-citation: true
link-color: blue
header-includes:
  - \usepackage{soulutf8}
  - \usepackage{color}
  - \usepackage{float}
  - \usepackage{booktabs}
  - \usepackage{lscape}
  - \usepackage{setspace}
  - \usepackage{dcolumn}
abstract: |
  This is the abstract.

  It consists of two paragraphs.

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, eval=FALSE, cache = TRUE, fig.pos = 'H')
```

\newcommand{\blandscape}{\begin{landscape}}
\newcommand{\elandscape}{\end{landscape}}
\doublespacing

Introduction
============

\hl{government health expenditure and life expectancy.}

[@wagstaff2018progress].

# Special issue information

Universal health coverage (UHC) is one of the key approaches in achieving the 2030 Agenda for Sustainable Development Goals (SDGs). On October 25-26, 2018, the Global Conference on Primary Health Care was held in Kazakhstan, and the Declaration of Astana was signed by 197 Member States under the leadership of the World Health Organization (WHO). In this Declaration, strengthening primary health care system has been considered as an essential step towards achieving Universal Health Coverage.

This thematic series of articles is being launched by the Global Health Research and Policy (GHRP) to serve as a platform to disseminate current research findings, insights, new perspectives, and policy recommendations in promoting UHC worldwide. This will serve to create better knowledge transfer from researches to policy-making and practices and for information and experience sharing. GHRP is encouraging submissions of commentaries, reviews, research articles, and short report of policies on the key elements of UHC. Elements that can be covered in the submissions may include, but not limited to the following:

- Health financing system strengthening, with special focus on the development of health financial protection schemes for the disadvantaged population, as well as the integration of different insurance programs.

- Primary healthcare system strengthening, with special focus on health workforce and delivery network of primary health care services, equity and quality of primary health care, information systems construction, etc.

- People-centered health care system, with special focus on the integration of specialist healthcare services and primary health care, and the provision of continuous services to improve patient experience, etc.

- Essential medicines and health products, with special focus on strategic purchasing, relevant mechanism designs and market entry for insurance benefit package.

- Medical assistance programs for poverty alleviation as an approach to increase UHC.

This thematic series will be guest edited by Dr. Beibei Yuan (beibeiyuan@bjmu.edu.cn), Associate Professor from Peking University and Dr. Lanting Lu (lanting.lu@ruc.edu.cn), Associate Professor from Renmin University of China.

Submissions from anywhere in the world are welcome. Authors are advised to select the Thematic Series option "Universal Health Coverage" during their submission. The deadline of submission is on **April 14, 2019**.  





Methods
=======

Data souce
----------

We extracted country level data from the Global Health Expenditure Database on the World Health Organization (WHO) website.[@WHOdata] This database includes comparable health expenditure data for around 190 countries from 2000 to 2016. Besides, we downloaded Life expectancy data by country from the Global Health Observatory data repository provided by the WHO.[@WHOlife] 


Variable selection
------------------

Outcome: life expectancy

Independent variables: life expectancy

Variable selection:

- Current Health Expenditure (CHE) as % GDP: CHEGDP_SHA2011
- Government Health Expenditure (GGHE-D) as % GDP: GGHEDGDP_SHA2011
- Domestic Private Health Expenditure (PVT-D) as % CHE: PVTDCHE_SHA2011
- Compulsory Financing Arrangements (CFA) as % of CHE: CFACHE_SHA2011
- OOP % CHE: OOPSCHE_SHA2011
- Population 
- GDP 
- Year

Multi-collinearity:

CFACHE_SHA2011 - kept only
GFACHE_SHA2011
CHICHE_SHA2011

Statistical Analyses
--------------------


Point and interval estimates (95% confidence intervals, 95% CI), as well as the p-values, were reported for all indepdent variables. A p-value less than 0.05 is viewed as statistically significant. All data cleaning, visualization, statistical modelling, and reporting were performed using R 3.5.3 [@R353]. In an effort to promote reproducible research, we have created a public GitHub repository to store all the data and R code we use to write this paper. 
Interested readers can find them at [https://github.com/caimiao0714/GHRP-UHC](https://github.com/caimiao0714/GHRP-UHC).









Results
=======


```{r eval=FALSE}
pacman::p_load(tidyverse, tidyr)
#d1 = rio::import('Data/AllData.xlsx')
#data.table::fwrite(d1, 'Data/alldat.csv')
d0 = data.table::fread('Data/alldat.csv')
codebook = d0[!duplicated(d0$`Indicator Code`),5:7]
#data.table::fwrite(codebook, 'Data/codebook.csv')

d1 = d0 %>% 
  select(`Country Name`, `Country Code`, `Country WHO Region`, `Country Income Group`, 
         `Indicator Code`, Year, Value) %>% 
  spread(`Indicator Code`, Value) %>% 
  select(c(1:ncol(.))[colSums(is.na(.)) < 500])

var_sel = names(d1)
codebook1 = codebook[codebook$`Indicator Code` %in% names(d1),]
#data.table::fwrite(codebook1, 'Data/codebook1.csv')

life = data.table::fread('Data/life-expectancy-who/Life Expectancy Data.csv')
f0 = d1[life, on = c(`Country Name` = 'Country', Year = 'Year')]
data.table::fwrite(f0, 'Data/f0.csv')
```


```{r eval=FALSE}
pacman::p_load(tidyverse)
f0 = readr::read_csv('Data/f0.csv')

# adjusting legend alpha:
# https://stackoverflow.com/questions/40944239/removing-ggplot2-legend-removes-whole-data-from-the-plot
windowsFonts(Times=windowsFont("Times New Roman"))
f0 %>% 
  filter(!is.na(`Country Income Group`)) %>% 
  mutate(`Country Income Group` = ifelse(`Country Income Group` == 'Hi',
                                         'High', `Country Income Group`)) %>% 
  mutate(`Country Income Group` = factor(`Country Income Group`, 
                                         levels = c('Low', 'Low-Mid', 'Up-Mid', 'High'))) %>%
  ggplot(aes(x = Year, y = `Life expectancy`,
             group = `Country Name`, color = `Country Income Group`)) + 
  geom_line(alpha = 0.5, size = 0.4) +
  theme_bw() + ylab('Life expectancy in each country') +
  scale_x_continuous("Year", labels = as.character(2000:2015), breaks = 2000:2015)+
  theme(legend.justification = c(1, 1), legend.position = c(0.6, 0.1),
        legend.background = element_rect(fill=alpha('white', 0.8)),
        legend.direction="horizontal", text=element_text(family="Times"))+ 
  guides(color=guide_legend(title="Income group", 
                            override.aes = list(alpha = 1, size = 2)))
# Country Income Group, Country WHO Region
ggsave('Figures/fig1.pdf', width = 10, height = 6.18)
```

```{r fig1, eval=TRUE,fig.cap='Life expectancy in 139 countries from 2000 to 2015'}
knitr::include_graphics('Figures/fig1.pdf')
```

Figure \@ref(fig:fig1)



```{r eval=TRUE}
pacman::p_load(tidyverse, stargazer)
f0 = data.table::fread('Data/f0.csv')
names(f0)=c('CountryName', 'CountryCode', 'WHORegion', 'Country Income Group', 
            'Year', "CFACHE_SHA2011", "CHEGDP_SHA2011", "CHE_pc_PPP_SHA2011",
            "CHE_pc_US_SHA2011", "CHICHE_SHA2011", "DOMCHE_SHA2011", "GFACHE_SHA2011",
            "GGHEDCHE_SHA2011", "GGHEDGDP_SHA2011", "GGHEDGGE_SHA2011",
            "GGHED_pc_PPP_SHA2011", "GGHED_pc_US_SHA2011", "OOP_pc_PPP_SHA2011",
            "OOP_pc_US_SHA2011", "OOPSCHE_SHA2011", "OTHERCHE_SHA2011", "PVTDCHE_SHA2011",
            "PVTD_pc_PPP_SHA2011", "PVTD_pc_US_SHA2011", "sha11FS", "sha11FS1", 
            "sha11FS11", "sha11FS5", "sha11FS6", "sha11FS61", "sha11HF", "sha11HF1",
            "sha11HF11", "sha11HF2", "sha11HF21", "sha11HF3", "VFACHE_SHA2011",
            "VHICHE_SHA2011", "Status", "Lifeexpectancy", "AdultMortality", "infantdeaths",
            "Alcohol", "percentageexpenditure", "HepatitisB", "Measles", "BMI",
            "underfivedeaths", "Polio", "Totalexpenditure", "Diphtheria", "HIVAIDS", 
            "GDP", "Population", "thinness119", "thinness59", "IncomeComp", "Schooling")

#f1 = f0[f0$CHICHE_SHA2011 != 0&!is.na(f0$CHICHE_SHA2011),]
f1 = f0 %>% 
  select(CountryName, Lifeexpectancy, CHEGDP_SHA2011, GGHEDGDP_SHA2011, PVTDCHE_SHA2011,
    CFACHE_SHA2011, OOPSCHE_SHA2011, Population, GDP, Year, `Country Income Group`) %>% 
  mutate(Population = Population/1000000,
         GDP = GDP/1000) %>% 
  na.omit() %>% 
  data.table::data.table()
data.table::fwrite(f1, 'Data/f1.csv')

options(scipen = 999)
fit01 = lm(
  Lifeexpectancy ~ CHEGDP_SHA2011 + GGHEDGDP_SHA2011 + PVTDCHE_SHA2011 +
    CFACHE_SHA2011 + OOPSCHE_SHA2011 + Population + GDP + Year + `Country Income Group`, 
  data = f1)

fit_hi = lm(Lifeexpectancy ~  CHEGDP_SHA2011 + GGHEDGDP_SHA2011 + PVTDCHE_SHA2011 + 
             CFACHE_SHA2011 + OOPSCHE_SHA2011 + Population + GDP + Year, 
           data = f1[f1$`Country Income Group` == 'Hi',])
fit_upmid = lm(Lifeexpectancy ~  CHEGDP_SHA2011 + GGHEDGDP_SHA2011 + PVTDCHE_SHA2011 + 
             CFACHE_SHA2011 + OOPSCHE_SHA2011 + Population + GDP + Year, 
           data = f1[f1$`Country Income Group` == 'Up-Mid',])
fit_lowmid = lm(Lifeexpectancy ~  CHEGDP_SHA2011 + GGHEDGDP_SHA2011 + PVTDCHE_SHA2011 + 
             CFACHE_SHA2011 + OOPSCHE_SHA2011 + Population + GDP + Year, 
           data = f1[f1$`Country Income Group` == 'Low-Mid',])
fit_low = lm(Lifeexpectancy ~  CHEGDP_SHA2011 + GGHEDGDP_SHA2011 + PVTDCHE_SHA2011 + 
             CFACHE_SHA2011 + OOPSCHE_SHA2011 + Population + GDP + Year, 
           data = f1[f1$`Country Income Group` == 'Low',])
```

\hl{Xiaojun Lin, create the Table 1 for f1. write results for Table 1, 2, 3 and Figure 1.}

```{r}
# NEED A TABLE 1 for HERE for f1
f1 = data.table::fread('Data/f1.csv')
```



```{r results='asis', eval=TRUE}
stargazer(fit01, dep.var.labels=c("Life expectancy"), label = 'poolOLS',
          title="OLS model predicting life expectancies in 139 countries from 2000 to 2015",
covariate.labels=c(
  "Current Health Expenditure as percent of GDP",
  "Government Health Expenditure as percent of GDP", 
  "Private Health Expenditure as percent CHE",
  "Compulsory Financing Arrangements as percent of CHE",
  "Out-of-pocket payment as percent of CHE", 
  "Population (millions)", "GDP","Year", 
  "Low income country", "Low to middle income country", 
  "Up to middel income country", "Constant"),
  omit.stat=c("LL","ser","f"), ci=TRUE, ci.level=0.95, 
  single.row=FALSE, header=FALSE, 
  notes = c("CHE: Current Health Expenditure,", 
           "GDP: Gross Domestic Product",
           "GHE: Government Health Expenditure",
           "PVT-D: Private Health Expenditure",
           "OOP: Out-of-pocket payment",
           "CFA: Compulsory Financing Arrangements"),
  notes.append = TRUE, notes.align = 'l')
```

Table \@ref(poolOLS) demonstrates XXXXXXX.

\blandscape
```{r results='asis', eval=TRUE}
stargazer(fit_low, fit_lowmid, fit_upmid, fit_hi, label = 'stratifiedOLS',
          dep.var.labels=c("Life expectancy"),
          title="OLS model predicting life expectancies from 2000 to 2015 stratifeid by country income categories", align=TRUE, 
          covariate.labels=c(
  "Current Health Expenditure as percent of GDP",
  "Government Health Expenditure as percent of GDP", 
  "Private Health Expenditure as percent CHE",
  "Compulsory Financing Arrangements as percent of CHE",
  "Out-of-pocket payment as percent of CHE", 
  "Population (millions)", "GDP","Year", "Constant"),
          column.labels=c("Low","Low-mid", "Up-mid", "High"),
          omit.stat=c("LL","ser","f"), ci=TRUE, single.row=FALSE, header=FALSE)
```
\elandscape

Table \@ref(stratifiedOLS) presents XXXXXXX.

Discussion
==========



References {-}
==========
