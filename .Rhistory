# adjusting legend alpha:
# https://stackoverflow.com/questions/40944239/removing-ggplot2-legend-removes-whole-data-from-the-plot
windowsFonts(Times=windowsFont("Times New Roman"))
f1 %>%
filter(!is.na(CountryIncomeGroup)) %>%
mutate(CountryIncomeGroup = ifelse(CountryIncomeGroup == 'Hi',
'High', CountryIncomeGroup)) %>%
mutate(CountryIncomeGroup = factor(CountryIncomeGroup,
levels = c('Low', 'Low-Mid', 'Up-Mid', 'High'))) %>%
ggplot(aes(x = Year, y = Lifeexpectancy,
group = CountryName, color = CountryIncomeGroup)) +
geom_line(alpha = 0.5, size = 0.1) +
theme_bw() + ylab('Life expectancy in each country') +
scale_x_continuous("Year", labels = as.character(2000:2015), breaks = 2000:2015)+
theme(legend.justification = c(1, 1), legend.position = c(0.95, 0.1),
legend.background = element_rect(fill=alpha('white', 0.8)),
legend.direction="horizontal", text=element_text(family="Times"))+
guides(color=guide_legend(title="Income group",
override.aes = list(alpha = 1, size = 2)))
# Country Income Group, Country WHO Region
ggsave('Figures/fig1.pdf', width = 10, height = 6.18)
f1 = data.table::fread('Data/f1.csv')
names(f1)
vars <- c("Lifeexpectancy", "CHEGDP_SHA2011", "GGHE_DGDP_SHA2011", "PVT_DCHE_SHA2011",
"CFACHE_SHA2011",  "CHICHE_SHA2011", "OOPSCHE_SHA2011", "Population", "GDP" )
tab1 <- print(CreateContTable(vars, strata = "Country Income Group" , data = f1), printToggle = FALSE) %>% as.data.frame() %>% select(c(2:4, 1))
require(tableone)
require(tidyverse)
tab1 <- print(CreateContTable(vars, strata = "Country Income Group" , data = f1), printToggle = FALSE) %>% as.data.frame() %>% select(c(2:4, 1))
rownames(tab1) <- c(
'N',
'Life Expectancies',
'Current health expenditure as percent of GDP',
'Government Health Expenditure as percent of GDP',
'Private health expenditure as percent CHE',
'Out-of-pocket payment as percent of CHE',
'Compulsory financing arrangements as percent of CHE',
'Compulsory health insurance as percent of CHE',
'Population (millions)',
'GDP'
)
colnames(tab1) <- c("Low", "Low-Mid", "Up-Mid", "High")
vars <- c("Lifeexpectancy", "CHEGDP_SHA2011", "GGHE_DGDP_SHA2011", "PVT_DCHE_SHA2011",
"CFACHE_SHA2011",  "CHICHE_SHA2011", "OOPSCHE_SHA2011", "Population", "GDP" )
tab1 <- print(CreateContTable(vars, strata = "CountryIncomeGroup" , data = f1), printToggle = FALSE) %>% as.data.frame() %>% select(c(2:4, 1))
rownames(tab1) <- c(
'N',
'Life Expectancies',
'Current health expenditure as percent of GDP',
'Government Health Expenditure as percent of GDP',
'Private health expenditure as percent CHE',
'Out-of-pocket payment as percent of CHE',
'Compulsory financing arrangements as percent of CHE',
'Compulsory health insurance as percent of CHE',
'Population (millions)',
'GDP'
)
colnames(tab1) <- c("Low", "Low-Mid", "Up-Mid", "High")
tab1
f1 = data.table::fread('Data/f1.csv')
require(tableone)
require(tidyverse)
vars <- c("Lifeexpectancy", "CHEGDP_SHA2011", "GGHE_DGDP_SHA2011", "PVT_DCHE_SHA2011",
"OOPSCHE_SHA2011", "CFACHE_SHA2011",  "CHICHE_SHA2011", "OOPSCHE_SHA2011",
"Population", "GDP" )
tab1 <- print(CreateContTable(vars, strata = "CountryIncomeGroup" , data = f1)
, printToggle = FALSE) %>%
as.data.frame() %>% select(c(2:4, 1))
rownames(tab1) <- c(
'N',
'Life Expectancies',
'Current health expenditure as percent of GDP',
'Government Health Expenditure as percent of GDP',
'Private health expenditure as percent CHE',
'Out-of-pocket payment as percent of CHE',
'Compulsory financing arrangements as percent of CHE',
'Compulsory health insurance as percent of CHE',
'Population (millions)',
'GDP'
)
colnames(tab1) <- c("Low", "Low-Mid", "Up-Mid", "High")
print(CreateContTable(vars, strata = "CountryIncomeGroup" , data = f1)
, printToggle = FALSE) %>%
as.data.frame()
f1 %>%
mutate(CountryIncomeGroup = factor(CountryIncomeGroup, levels = c("Low", "Low-Mid", "Up-Mid", "Hi"))) %>%
print(CreateContTable(vars, strata = "CountryIncomeGroup", data = .)
, printToggle = FALSE) %>%
as.data.frame()
f1 %>%
mutate(CountryIncomeGroup = factor(CountryIncomeGroup, levels = c("Low", "Low-Mid", "Up-Mid", "Hi")))
f1 %>%
mutate(CountryIncomeGroup = factor(CountryIncomeGroup, levels = c("Low", "Low-Mid", "Up-Mid", "Hi"))) %>%
print(CreateContTable(vars, strata = "CountryIncomeGroup", data = .)
, printToggle = FALSE)
print(CreateContTable(vars, strata = "CountryIncomeGroup", data = f1)
, printToggle = FALSE) %>%
as.data.frame() %>% select(c(2:4, 1))
f1 = data.table::fread('Data/f1.csv')
require(tableone)
require(tidyverse)
vars <- c("Lifeexpectancy", "CHEGDP_SHA2011", "GGHE_DGDP_SHA2011", "PVT_DCHE_SHA2011",
"OOPSCHE_SHA2011", "CFACHE_SHA2011",  "CHICHE_SHA2011", "Population", "GDP" )
tab1 <- print(CreateContTable(vars, strata = "CountryIncomeGroup", data = f1)
, printToggle = FALSE) %>%
as.data.frame() %>% select(c(2:4, 1))
rownames(tab1) <- c(
'N',
'Life Expectancy',
'Current health expenditure as percent of GDP',
'Government Health Expenditure as percent of GDP',
'Private health expenditure as percent CHE',
'Out-of-pocket payment as percent of CHE',
'Compulsory financing arrangements as percent of CHE',
'Compulsory health insurance as percent of CHE',
'Population (millions)',
'GDP'
)
colnames(tab1) <- c("Low", "Low-Mid", "Up-Mid", "High")
fit01 = lm(
Lifeexpectancy ~ CHEGDP_SHA2011 + GGHE_DGDP_SHA2011 +  PVT_DCHE_SHA2011 +
OOPSCHE_SHA2011 + CFACHE_SHA2011 + CHICHE_SHA2011 +
Population + GDP + Year + CountryIncomeGroup,
data = f1)
fit_hi = lm(Lifeexpectancy ~ CHEGDP_SHA2011 + GGHE_DGDP_SHA2011 +
PVT_DCHE_SHA2011 +  OOPSCHE_SHA2011 + CFACHE_SHA2011 +
CHICHE_SHA2011 +  Population + GDP + Year,
data = f1[f1$`Country Income Group` == 'Hi',])
fit_upmid = lm(Lifeexpectancy ~ CHEGDP_SHA2011 + GGHE_DGDP_SHA2011 +
PVT_DCHE_SHA2011 +  OOPSCHE_SHA2011 + CFACHE_SHA2011 +
CHICHE_SHA2011 +  Population + GDP + Year,
data = f1[f1$`Country Income Group` == 'Up-Mid',])
fit_lowmid = lm(Lifeexpectancy ~ CHEGDP_SHA2011 + GGHE_DGDP_SHA2011 +
PVT_DCHE_SHA2011 +  OOPSCHE_SHA2011 + CFACHE_SHA2011 +
CHICHE_SHA2011 +  Population + GDP + Year,
data = f1[f1$`Country Income Group` == 'Low-Mid',])
fit_low = lm(Lifeexpectancy ~ CHEGDP_SHA2011 + GGHE_DGDP_SHA2011 +
PVT_DCHE_SHA2011 +  OOPSCHE_SHA2011 + CFACHE_SHA2011 +
CHICHE_SHA2011 +  Population + GDP + Year,
data = f1[f1$`Country Income Group` == 'Low',])
summary(fit01)
fit01 = lm(
Lifeexpectancy ~ CHEGDP_SHA2011 + GGHE_DGDP_SHA2011 +  PVT_DCHE_SHA2011 +
OOPSCHE_SHA2011 + CFACHE_SHA2011 + CHICHE_SHA2011 +
Population + GDP + Year,
data = f1)
summary(fit01)
fit_hi = lm(Lifeexpectancy ~ CHEGDP_SHA2011 + GGHE_DGDP_SHA2011 +
PVT_DCHE_SHA2011 +  OOPSCHE_SHA2011 + CFACHE_SHA2011 +
CHICHE_SHA2011 +  Population + GDP + Year,
data = f1[f1$CountryIncomeGroup == 'Hi',])
pacman::p_load(tidyverse, stargazer)
fit01 = lm(
Lifeexpectancy ~ CHEGDP_SHA2011 + GGHE_DGDP_SHA2011 +  PVT_DCHE_SHA2011 +
OOPSCHE_SHA2011 + CFACHE_SHA2011 + CHICHE_SHA2011 +
Population + GDP + Year + CountryIncomeGroup,
data = f1)
fit_hi = lm(Lifeexpectancy ~ CHEGDP_SHA2011 + GGHE_DGDP_SHA2011 +
PVT_DCHE_SHA2011 +  OOPSCHE_SHA2011 + CFACHE_SHA2011 +
CHICHE_SHA2011 +  Population + GDP + Year,
data = f1[f1$CountryIncomeGroup == 'Hi',])
fit_upmid = lm(Lifeexpectancy ~ CHEGDP_SHA2011 + GGHE_DGDP_SHA2011 +
PVT_DCHE_SHA2011 +  OOPSCHE_SHA2011 + CFACHE_SHA2011 +
CHICHE_SHA2011 +  Population + GDP + Year,
data = f1[f1$CountryIncomeGroup == 'Up-Mid',])
fit_lowmid = lm(Lifeexpectancy ~ CHEGDP_SHA2011 + GGHE_DGDP_SHA2011 +
PVT_DCHE_SHA2011 +  OOPSCHE_SHA2011 + CFACHE_SHA2011 +
CHICHE_SHA2011 +  Population + GDP + Year,
data = f1[f1$CountryIncomeGroup == 'Low-Mid',])
fit_low = lm(Lifeexpectancy ~ CHEGDP_SHA2011 + GGHE_DGDP_SHA2011 +
PVT_DCHE_SHA2011 +  OOPSCHE_SHA2011 + CFACHE_SHA2011 +
CHICHE_SHA2011 +  Population + GDP + Year,
data = f1[f1$CountryIncomeGroup == 'Low',])
stargazer(fit01)
stargazer(tab1, summary = FALSE)
stargazer::stargazer(tab1, summary = FALSE, label = 'descriptive',
title="Characteristics of the countries by income group, 2000 - 2015",
single.row=FALSE, header=FALSE, font.size='small',align = 'l')
tab1
f1 = data.table::fread('Data/f1.csv')
require(tableone)
require(tidyverse)
vars <- c("Lifeexpectancy", "CHEGDP_SHA2011", "GGHE_DGDP_SHA2011", "PVT_DCHE_SHA2011",
"OOPSCHE_SHA2011", "CFACHE_SHA2011",  "CHICHE_SHA2011", "Population", "GDP" )
tab1 <- print(CreateContTable(vars, strata = "CountryIncomeGroup", data = f1)
, printToggle = FALSE) %>%
as.data.frame() %>% select(c(2:4, 1))
rownames(tab1) <- c(
'N',
'Life Expectancy',
'Current health expenditure as percent of GDP',
'Government Health Expenditure as percent of GDP',
'Private health expenditure as percent CHE',
'Out-of-pocket payment as percent of CHE',
'Compulsory financing arrangements as percent of CHE',
'Compulsory health insurance as percent of CHE',
'Population (millions)',
'GDP'
)
tab1 = data.table::data.table(tab1)
setDT(tab1, keep.rownames = TRUE)[]
names(tab1) <- c("Low", "Low-Mid", "Up-Mid", "High")
f1 = data.table::fread('Data/f1.csv')
require(tableone)
require(tidyverse)
vars <- c("Lifeexpectancy", "CHEGDP_SHA2011", "GGHE_DGDP_SHA2011", "PVT_DCHE_SHA2011",
"OOPSCHE_SHA2011", "CFACHE_SHA2011",  "CHICHE_SHA2011", "Population", "GDP" )
tab1 <- print(CreateContTable(vars, strata = "CountryIncomeGroup", data = f1)
, printToggle = FALSE) %>%
as.data.frame() %>% select(c(2:4, 1))
rownames(tab1) <- c(
'N',
'Life Expectancy',
'Current health expenditure as percent of GDP',
'Government Health Expenditure as percent of GDP',
'Private health expenditure as percent CHE',
'Out-of-pocket payment as percent of CHE',
'Compulsory financing arrangements as percent of CHE',
'Compulsory health insurance as percent of CHE',
'Population (millions)',
'GDP'
)
tab1 = data.table::data.table(tab1)
data.table::setDT(tab1, keep.rownames = TRUE)[]
names(tab1) <- c("Low", "Low-Mid", "Up-Mid", "High")
tab1 = data.table::setDT(tab1, keep.rownames = TRUE)[]
tab1
f1 = data.table::fread('Data/f1.csv')
require(tableone)
require(tidyverse)
vars <- c("Lifeexpectancy", "CHEGDP_SHA2011", "GGHE_DGDP_SHA2011", "PVT_DCHE_SHA2011",
"OOPSCHE_SHA2011", "CFACHE_SHA2011",  "CHICHE_SHA2011", "Population", "GDP" )
tab1 <- print(CreateContTable(vars, strata = "CountryIncomeGroup", data = f1)
, printToggle = FALSE) %>%
as.data.frame() %>% select(c(2:4, 1))
tab1 = data.table::data.table(tab1)
rownames(tab1) <- c(
'N',
'Life Expectancy',
'Current health expenditure as percent of GDP',
'Government Health Expenditure as percent of GDP',
'Private health expenditure as percent CHE',
'Out-of-pocket payment as percent of CHE',
'Compulsory financing arrangements as percent of CHE',
'Compulsory health insurance as percent of CHE',
'Population (millions)',
'GDP'
)
tab1 = data.table::setDT(tab1, keep.rownames = TRUE)[]
names(tab1) <- c("Low", "Low-Mid", "Up-Mid", "High")
tab1
View(tab1)
tab1 <- print(CreateContTable(vars, strata = "CountryIncomeGroup", data = f1)
, printToggle = FALSE) %>%
as.data.frame() %>% select(c(2:4, 1))
tab1 <- print(CreateContTable(vars, strata = "CountryIncomeGroup", data = f1)
, printToggle = FALSE) %>%
as.data.frame()
tab1
, printToggle = FALSE) %>%
as.data.frame() %>% select(c(2:4, 1)) %>%
add_column(varnames = varnames, before = 1)
varnames <- c(
'N',
'Life Expectancy',
'Current health expenditure as percent of GDP',
'Government Health Expenditure as percent of GDP',
'Private health expenditure as percent CHE',
'Out-of-pocket payment as percent of CHE',
'Compulsory financing arrangements as percent of CHE',
'Compulsory health insurance as percent of CHE',
'Population (millions)',
'GDP'
)
, printToggle = FALSE) %>%
as.data.frame() %>% select(c(2:4, 1)) %>%
add_column(varnames = varnames, before = 1)
tab1 <- print(CreateContTable(vars, strata = "CountryIncomeGroup", data = f1),
printToggle = FALSE) %>%
as.data.frame() %>% select(c(2:4, 1)) %>%
add_column(varnames = varnames, before = 1)
tab1
tab1 <- print(CreateContTable(vars, strata = "CountryIncomeGroup", data = f1),
printToggle = FALSE) %>%
as.data.frame() %>% select(c(2:4, 1))
tab1
tab1 <- print(CreateContTable(vars, strata = "CountryIncomeGroup", data = f1),
printToggle = FALSE) %>%
as.data.frame() %>% select(c(2:4, 1)) %>%
rownames_to_column()
tab1
tab1 <- print(CreateContTable(vars, strata = "CountryIncomeGroup", data = f1),
printToggle = FALSE) %>%
as.data.frame() %>% select(c(2:4, 1)) %>%
rownames_to_column() %>%
mutate(rowname = varnames)
tab1
tab1 <- print(CreateContTable(vars, strata = "CountryIncomeGroup", data = f1),
printToggle = FALSE) %>%
as.data.frame() %>% select(c(2:4, 1)) %>%
rownames_to_column() %>%
mutate(rowname = varnames) %>%
set_colnames(c("Variables", "Low", "Low-Mid", "Up-Mid", "High"))
tab1 <- print(CreateContTable(vars, strata = "CountryIncomeGroup", data = f1),
printToggle = FALSE) %>%
as.data.frame() %>% select(c(2:4, 1)) %>%
rownames_to_column() %>%
mutate(rowname = varnames) %>%
setNames(c("Variables", "Low", "Low-Mid", "Up-Mid", "High"))
tab1
print(CreateContTable(vars, strata = "CountryIncomeGroup", data = f1),
printToggle = FALSE) %>%
as.data.frame() %>% select(c(2:4, 1)) %>%
rownames_to_column() %>%
mutate(rowname = varnames)
View(tab1)
tab1 <- print(CreateContTable(vars, strata = "CountryIncomeGroup", data = f1),
printToggle = FALSE) %>%
as.data.frame() %>% select(c(2:4, 1)) %>%
rownames_to_column() %>%
mutate(rowname = varnames) %>%
remove_rownames() %>%
setNames(c("Variables", "Low", "Low-Mid", "Up-Mid", "High"))
tab1
tab1 <- print(CreateContTable(vars, strata = "CountryIncomeGroup", data = f1),
printToggle = FALSE) %>%
as.data.frame() %>% select(c(2:4, 1)) %>%
rownames_to_column() %>%
mutate(rowname = varnames) %>%
remove_rownames() %>%
setNames(c("Variables", "Low", "Low-Mid", "Up-Mid", "High"))
stargazer::stargazer(tab1, summary = FALSE, label = 'descriptive',
title="Characteristics of the countries by income group, 2000 - 2015",
single.row=FALSE, header=FALSE, font.size='small',align = TRUE)
tab1
print(CreateContTable(vars, strata = "CountryIncomeGroup", data = f1),
printToggle = FALSE) %>%
as.data.frame() %>% select(c(2:4, 1)) %>%
rownames_to_column() %>%
mutate(rowname = varnames)
print(CreateContTable(vars, strata = "CountryIncomeGroup", data = f1),
printToggle = FALSE) %>%
as.data.frame() %>% select(c(2:4, 1)) %>%
rownames_to_column() %>%
mutate(rowname = varnames) %>%
remove_rownames()
tab1 <- print(CreateContTable(vars, strata = "CountryIncomeGroup", data = f1),
printToggle = FALSE) %>%
as.data.frame() %>% select(c(2:4, 1)) %>%
rownames_to_column() %>%
mutate(rowname = varnames) %>%
remove_rownames()
row.names(tab1) = NULL
tab1
stargazer(fit_low, fit_lowmid, fit_upmid, fit_hi, label = 'stratifiedOLS',
dep.var.labels=c("Life expectancy"),
title="OLS model predicting life expectancies from 2000 to 2015 stratifeid by country income categories", align=TRUE,
covariate.labels=c(
"Current Health Expenditure as percent of GDP",
"Government Health Expenditure as percent of GDP",
"Private Health Expenditure as percent CHE",
"Out-of-pocket payment as percent of CHE",
"Compulsory Financing Arrangements as percent of CHE",
"Compulsory health insurance as percent of CHE",
"Population (millions)", "GDP","Year", "Constant"),
column.labels=c("Low","Low-mid", "Up-mid", "High"),
omit.stat=c("LL","ser","f"), ci=TRUE, single.row=FALSE,
header=FALSE, font.size='small')
knitr::opts_chunk$set(echo = FALSE, eval=FALSE, cache = FALSE, fig.pos = 'H')
f1 = data.table::fread('Data/f1.csv')
View(f1)
require(tableone)
require(tableone)
require(tidyverse)
require(tableone)
require(tidyverse)
vars <- c("Lifeexpectancy", "CHEGDP_SHA2011", "GGHE_DGDP_SHA2011", "PVT_DCHE_SHA2011",
"OOPSCHE_SHA2011", "CFACHE_SHA2011",  "CHICHE_SHA2011", "Population", "GDP" )
tab1 <- print(CreateContTable(vars, strata = "CountryIncomeGroup", data = f1),
printToggle = FALSE) %>%
as.data.frame() %>% select(c(2:4, 1))
row.names(tab1) = c(
'N',
'Life Expectancy',
'Current health expenditure as percent of GDP',
'Government Health Expenditure as percent of GDP',
'Private health expenditure as percent CHE',
'Out-of-pocket payment as percent of CHE',
'Compulsory financing arrangements as percent of CHE',
'Compulsory health insurance as percent of CHE',
'Population (millions)',
'GDP'
)
names(tab1) = c("Low", "Low-Mid", "Up-Mid", "High")
require(kableExtra)
kable(tab1, caption = "Characteristics of the 184 countries by income group, 2000 - 2016",
format = "latex", booktabs = T) %>%
kable_styling(latex_options = "scale_down") %>%
footnote(general = "GDP: Gross Domestic Product; CHE: Current Health Expenditure")
fit01 = lm(
Lifeexpectancy ~ CHEGDP_SHA2011 + GGHE_DGDP_SHA2011 +  PVT_DCHE_SHA2011 +
OOPSCHE_SHA2011 + CFACHE_SHA2011 + CHICHE_SHA2011 +
Population + GDP + Year + CountryIncomeGroup,
data = f1)
summary(fit01)
fit01 = lm(
Lifeexpectancy ~ CHEGDP_SHA2011 + GGHE_DGDP_SHA2011 +  PVT_DCHE_SHA2011 +
OOPSCHE_SHA2011 + CFACHE_SHA2011 + CHICHE_SHA2011 +
Population + GDP + as.factor(Year) + CountryIncomeGroup,
data = f1)
summary(fit01)
summary(fit01)
fit_hi = lm(Lifeexpectancy ~ CHEGDP_SHA2011 + GGHE_DGDP_SHA2011 +
PVT_DCHE_SHA2011 +  OOPSCHE_SHA2011 + CFACHE_SHA2011 +
CHICHE_SHA2011 +  Population + GDP + Year,
data = f1[f1$CountryIncomeGroup == 'Hi',])
fit_upmid = lm(Lifeexpectancy ~ CHEGDP_SHA2011 + GGHE_DGDP_SHA2011 +
PVT_DCHE_SHA2011 +  OOPSCHE_SHA2011 + CFACHE_SHA2011 +
CHICHE_SHA2011 +  Population + GDP + as.factor(Year),
data = f1[f1$CountryIncomeGroup == 'Up-Mid',])
fit_lowmid = lm(Lifeexpectancy ~ CHEGDP_SHA2011 + GGHE_DGDP_SHA2011 +
PVT_DCHE_SHA2011 +  OOPSCHE_SHA2011 + CFACHE_SHA2011 +
CHICHE_SHA2011 +  Population + GDP + as.factor(Year),
data = f1[f1$CountryIncomeGroup == 'Low-Mid',])
fit_low = lm(Lifeexpectancy ~ CHEGDP_SHA2011 + GGHE_DGDP_SHA2011 +
PVT_DCHE_SHA2011 +  OOPSCHE_SHA2011 + CFACHE_SHA2011 +
CHICHE_SHA2011 +  Population + GDP + as.factor(Year),
data = f1[f1$CountryIncomeGroup == 'Low',])
summary(fit_hi)
fit_hi = lm(Lifeexpectancy ~ CHEGDP_SHA2011 + GGHE_DGDP_SHA2011 +
PVT_DCHE_SHA2011 +  OOPSCHE_SHA2011 + CFACHE_SHA2011 +
CHICHE_SHA2011 +  Population + GDP + as.factor(Year),
data = f1[f1$CountryIncomeGroup == 'Hi',])
summary(fit_hi)
pacman::p_load(tidyverse, stargazer)
fit01 = lm(
Lifeexpectancy ~ CHEGDP_SHA2011 + GGHE_DGDP_SHA2011 +  PVT_DCHE_SHA2011 +
OOPSCHE_SHA2011 + CFACHE_SHA2011 + CHICHE_SHA2011 +
Population + GDP + Year + CountryIncomeGroup,
data = f1)
fit_hi = lm(Lifeexpectancy ~ CHEGDP_SHA2011 + GGHE_DGDP_SHA2011 +
PVT_DCHE_SHA2011 +  OOPSCHE_SHA2011 + CFACHE_SHA2011 +
CHICHE_SHA2011 +  Population + GDP + Year,
data = f1[f1$CountryIncomeGroup == 'Hi',])
fit_upmid = lm(Lifeexpectancy ~ CHEGDP_SHA2011 + GGHE_DGDP_SHA2011 +
PVT_DCHE_SHA2011 +  OOPSCHE_SHA2011 + CFACHE_SHA2011 +
CHICHE_SHA2011 +  Population + GDP + Year,
data = f1[f1$CountryIncomeGroup == 'Up-Mid',])
fit_lowmid = lm(Lifeexpectancy ~ CHEGDP_SHA2011 + GGHE_DGDP_SHA2011 +
PVT_DCHE_SHA2011 +  OOPSCHE_SHA2011 + CFACHE_SHA2011 +
CHICHE_SHA2011 +  Population + GDP + Year,
data = f1[f1$CountryIncomeGroup == 'Low-Mid',])
fit_low = lm(Lifeexpectancy ~ CHEGDP_SHA2011 + GGHE_DGDP_SHA2011 +
PVT_DCHE_SHA2011 +  OOPSCHE_SHA2011 + CFACHE_SHA2011 +
CHICHE_SHA2011 +  Population + GDP + Year,
data = f1[f1$CountryIncomeGroup == 'Low',])
pacman::p_load(tidyverse)
f1 = readr::read_csv('Data/f1.csv')
# adjusting legend alpha:
# https://stackoverflow.com/questions/40944239/removing-ggplot2-legend-removes-whole-data-from-the-plot
windowsFonts(Times=windowsFont("Times New Roman"))
f1 %>%
filter(!is.na(CountryIncomeGroup)) %>%
mutate(CountryIncomeGroup = ifelse(CountryIncomeGroup == 'Hi',
'High', CountryIncomeGroup)) %>%
mutate(CountryIncomeGroup = factor(CountryIncomeGroup,
levels = c('Low', 'Low-Mid', 'Up-Mid', 'High'))) %>%
ggplot(aes(x = Year, y = Lifeexpectancy,
group = CountryName, color = CountryIncomeGroup)) +
geom_line(alpha = 0.5, size = 0.1) +
theme_bw() + ylab('Life expectancy in each country') +
scale_x_continuous("Year", labels = as.character(2000:2016), breaks = 2000:2016)+
theme(legend.justification = c(1, 1), legend.position = c(0.95, 0.1),
legend.background = element_rect(fill=alpha('white', 0.8)),
legend.direction="horizontal", text=element_text(family="Times"))+
guides(color=guide_legend(title="Income group",
override.aes = list(alpha = 1, size = 2)))
# Country Income Group, Country WHO Region
ggsave('Figures/fig1.pdf', width = 10, height = 6.18)
pacman::p_load(tidyverse, tidyr)
#d1 = rio::import('Data/AllData.xlsx')
#data.table::fwrite(d1, 'Data/alldat.csv')
d0 = data.table::fread('Data/alldat.csv')
d1 = d0 %>%
select(`Country Name`, `Country Code`, `Country WHO Region`, `Country Income Group`,
`Indicator Code`, Year, Value) %>%
spread(`Indicator Code`, Value) %>%
select(c(1:ncol(.))[colSums(is.na(.)) < 500])
var_sel = names(d1)
codebook1 = codebook[codebook$`Indicator Code` %in% names(d1),]
knitr::opts_chunk$set(echo = FALSE, eval=FALSE, cache = FALSE, fig.pos = 'H')
f1 = data.table::fread('Data/f1.csv')
require(tableone)
require(tidyverse)
vars <- c("Lifeexpectancy", "CHEGDP_SHA2011", "GGHE_DGDP_SHA2011", "PVT_DCHE_SHA2011",
"OOPSCHE_SHA2011", "CFACHE_SHA2011",  "CHICHE_SHA2011", "Population", "GDP" )
tab1 <- print(CreateContTable(vars, strata = "CountryIncomeGroup", data = f1),
printToggle = FALSE) %>%
as.data.frame() %>% select(c(2:4, 1))
row.names(tab1) = c(
'N',
'Life Expectancy',
'Current health expenditure as percent of GDP',
'Government Health Expenditure as percent of GDP',
'Private health expenditure as percent CHE',
'Out-of-pocket payment as percent of CHE',
'Compulsory financing arrangements as percent of CHE',
'Compulsory health insurance as percent of CHE',
'Population (millions)',
'GDP'
)
names(tab1) = c("Low", "Low-Mid", "Up-Mid", "High")
